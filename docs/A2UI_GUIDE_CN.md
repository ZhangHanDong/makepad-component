# A2UI åè®®ä¸ Makepad æ¸²æŸ“å™¨æŒ‡å—

## ç›®å½•

1. [ä»€ä¹ˆæ˜¯ A2UI](#ä»€ä¹ˆæ˜¯-a2ui)
2. [åè®®æ¦‚è¿°](#åè®®æ¦‚è¿°)
3. [æ¶ˆæ¯ç±»å‹](#æ¶ˆæ¯ç±»å‹)
4. [ç»„ä»¶ç³»ç»Ÿ](#ç»„ä»¶ç³»ç»Ÿ)
5. [æ•°æ®ç»‘å®š](#æ•°æ®ç»‘å®š)
6. [Makepad æ¸²æŸ“å™¨å®ç°](#makepad-æ¸²æŸ“å™¨å®ç°)
7. [Demo åº”ç”¨](#demo-åº”ç”¨)
8. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)

---

## ä»€ä¹ˆæ˜¯ A2UI

**A2UI (Agent-to-UI)** æ˜¯ä¸€ä¸ªå¼€æºçš„å£°æ˜å¼ JSON åè®®ï¼Œä¸“ä¸º AI ä»£ç†ç”Ÿæˆäº¤äº’å¼ç”¨æˆ·ç•Œé¢è€Œè®¾è®¡ã€‚

### æ ¸å¿ƒç‰¹ç‚¹

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **å£°æ˜å¼ JSON** | çº¯æ•°æ®æè¿°ï¼Œæ— éœ€æ‰§è¡Œä»£ç ï¼Œè·¨ä¿¡ä»»è¾¹ç•Œå®‰å…¨ |
| **LLM ä¼˜åŒ–** | æ‰å¹³é‚»æ¥è¡¨æ ¼å¼ï¼Œä¾¿äºå¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆå’Œç†è§£ |
| **è·¨å¹³å°** | åŒä¸€å“åº”å¯åœ¨ Webã€ç§»åŠ¨ç«¯ã€æ¡Œé¢ç«¯æ¸²æŸ“ |
| **æµå¼ä¼ è¾“** | æ”¯æŒæ¸è¿›å¼ UI æ›´æ–°ï¼Œå†…å®¹ç”Ÿæˆæ—¶å³æ—¶æ˜¾ç¤º |

### ä¸ºä»€ä¹ˆéœ€è¦ A2UIï¼Ÿ

ä¼ ç»Ÿçš„ AI ä»£ç†åªèƒ½è¿”å›æ–‡æœ¬æˆ– Markdownï¼Œç”¨æˆ·ä½“éªŒå—é™ã€‚A2UI è®© AI ä»£ç†èƒ½å¤Ÿï¼š

- ç”Ÿæˆå®Œæ•´çš„è¡¨å•ç•Œé¢
- åˆ›å»ºå¯äº¤äº’çš„äº§å“åˆ—è¡¨
- æ„å»ºæ”¯ä»˜æµç¨‹é¡µé¢
- å®æ—¶æ›´æ–° UI çŠ¶æ€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AI ä»£ç†                                 â”‚
â”‚                         â”‚                                    â”‚
â”‚                    A2UI JSON                                 â”‚
â”‚                         â”‚                                    â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â–¼               â–¼               â–¼                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚  Web  â”‚      â”‚ Mobileâ”‚      â”‚  Desktop  â”‚            â”‚
â”‚     â”‚ (Lit) â”‚      â”‚(Flutter)â”‚    â”‚ (Makepad) â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åè®®æ¦‚è¿°

### é‚»æ¥è¡¨æ¨¡å‹

A2UI ä½¿ç”¨æ‰å¹³çš„é‚»æ¥è¡¨ç»“æ„ï¼Œè€Œéæ·±å±‚åµŒå¥—çš„ JSONã€‚è¿™ç§è®¾è®¡å¯¹ LLM æ›´å‹å¥½ï¼š

```json
{
  "surfaceUpdate": {
    "surfaceId": "main",
    "components": [
      {"id": "root", "component": {"Column": {"children": {"explicitList": ["title", "btn"]}}}},
      {"id": "title", "component": {"Text": {"text": {"literalString": "Hello"}}}},
      {"id": "btn", "component": {"Button": {"child": "btn-text", "action": {"name": "click"}}}}
    ]
  }
}
```

### ä¼˜åŠ¿

1. **å¢é‡æ›´æ–°** - åªéœ€å‘é€å˜åŒ–çš„ç»„ä»¶
2. **å¼•ç”¨ç®€å•** - é€šè¿‡ ID å¼•ç”¨å…¶ä»–ç»„ä»¶
3. **æ˜“äºç”Ÿæˆ** - LLM æ— éœ€è¿½è¸ªåµŒå¥—å±‚çº§
4. **æ˜“äºè§£æ** - æ¸²æŸ“å™¨å¯å¿«é€ŸæŸ¥æ‰¾ç»„ä»¶

---

## æ¶ˆæ¯ç±»å‹

A2UI å®šä¹‰äº† 5 ç§æ ¸å¿ƒæ¶ˆæ¯ç±»å‹ï¼š

### 1. beginRendering - åˆå§‹åŒ–ç•Œé¢

åˆ›å»ºæ–°çš„ UI è¡¨é¢ï¼Œè®¾ç½®æ ¹ç»„ä»¶ã€‚

```json
{
  "beginRendering": {
    "surfaceId": "main",
    "root": "root-column",
    "styles": {
      "primaryColor": "#007BFF",
      "font": "Roboto"
    }
  }
}
```

### 2. surfaceUpdate - æ›´æ–°ç»„ä»¶

æ·»åŠ æˆ–æ›´æ–°ç»„ä»¶æ ‘ä¸­çš„ç»„ä»¶ã€‚

```json
{
  "surfaceUpdate": {
    "surfaceId": "main",
    "components": [
      {
        "id": "greeting",
        "component": {
          "Text": {
            "text": {"literalString": "æ¬¢è¿ä½¿ç”¨"},
            "usageHint": "h1"
          }
        }
      }
    ]
  }
}
```

### 3. dataModelUpdate - æ›´æ–°æ•°æ®

æ›´æ–°æ•°æ®æ¨¡å‹ï¼Œé©±åŠ¨æ•°æ®ç»‘å®šçš„ç»„ä»¶è‡ªåŠ¨åˆ·æ–°ã€‚

```json
{
  "dataModelUpdate": {
    "surfaceId": "main",
    "path": "/user",
    "contents": [
      {"key": "name", "valueString": "å¼ ä¸‰"},
      {"key": "balance", "valueNumber": 1000.50},
      {"key": "vip", "valueBoolean": true}
    ]
  }
}
```

### 4. deleteSurface - åˆ é™¤ç•Œé¢

ç§»é™¤æ•´ä¸ª UI è¡¨é¢ã€‚

```json
{
  "deleteSurface": {
    "surfaceId": "main"
  }
}
```

### 5. userAction - ç”¨æˆ·æ“ä½œï¼ˆå®¢æˆ·ç«¯â†’æœåŠ¡ç«¯ï¼‰

ç”¨æˆ·è§¦å‘çš„æ“ä½œäº‹ä»¶ï¼Œå‘é€å›æœåŠ¡ç«¯ã€‚

```json
{
  "userAction": {
    "surfaceId": "main",
    "componentId": "pay-btn",
    "action": {
      "name": "confirmPayment",
      "context": {
        "amount": 344.75,
        "method": "alipay"
      }
    }
  }
}
```

---

## ç»„ä»¶ç³»ç»Ÿ

A2UI å®šä¹‰äº†ä¸€å¥—æ ‡å‡†ç»„ä»¶ç›®å½•ï¼Œåˆ†ä¸ºå››å¤§ç±»ï¼š

### å¸ƒå±€ç»„ä»¶

| ç»„ä»¶ | è¯´æ˜ | Makepad æ˜ å°„ |
|------|------|-------------|
| Column | å‚ç›´æ’åˆ— | `View` (flow: Down) |
| Row | æ°´å¹³æ’åˆ— | `View` (flow: Right) |
| List | å¯æ»šåŠ¨åˆ—è¡¨ | `PortalList` |
| Card | å¡ç‰‡å®¹å™¨ | `View` + åœ†è§’è¾¹æ¡† |

### æ˜¾ç¤ºç»„ä»¶

| ç»„ä»¶ | è¯´æ˜ | Makepad æ˜ å°„ |
|------|------|-------------|
| Text | æ–‡æœ¬æ˜¾ç¤º | `Label` / DrawText |
| Image | å›¾ç‰‡æ˜¾ç¤º | `Image` / DrawQuad |
| Icon | å›¾æ ‡ | è‡ªå®šä¹‰ç»˜åˆ¶ |
| Divider | åˆ†éš”çº¿ | DrawQuad |

### äº¤äº’ç»„ä»¶

| ç»„ä»¶ | è¯´æ˜ | Makepad æ˜ å°„ |
|------|------|-------------|
| Button | æŒ‰é’® | è‡ªå®šä¹‰ DrawQuad + äº‹ä»¶ |
| TextField | æ–‡æœ¬è¾“å…¥ | è‡ªå®šä¹‰è¾“å…¥ç»„ä»¶ |
| CheckBox | å¤é€‰æ¡† | è‡ªå®šä¹‰ç»˜åˆ¶ + äº‹ä»¶ |
| Slider | æ»‘å— | è‡ªå®šä¹‰è½¨é“ + æ»‘å— |

### å®¹å™¨ç»„ä»¶

| ç»„ä»¶ | è¯´æ˜ | Makepad æ˜ å°„ |
|------|------|-------------|
| Modal | æ¨¡æ€å¯¹è¯æ¡† | è¦†ç›–å±‚ View |
| Tabs | æ ‡ç­¾é¡µ | è‡ªå®šä¹‰åˆ‡æ¢ç»„ä»¶ |

### ç»„ä»¶ç¤ºä¾‹

#### Text ç»„ä»¶

```json
{
  "id": "title",
  "component": {
    "Text": {
      "text": {"literalString": "äº§å“åˆ—è¡¨"},
      "usageHint": "h1"
    }
  }
}
```

`usageHint` æ§åˆ¶æ ·å¼ï¼š
- `h1` - 28px æ ‡é¢˜
- `h2` - 22px å‰¯æ ‡é¢˜
- `h3` - 18px å°æ ‡é¢˜
- `body` - 14px æ­£æ–‡
- `caption` - 12px è¯´æ˜æ–‡å­—

#### Button ç»„ä»¶

```json
{
  "id": "submit-btn",
  "component": {
    "Button": {
      "child": "btn-text",
      "primary": true,
      "action": {
        "name": "submitForm",
        "context": [
          {"key": "formId", "value": {"literalString": "checkout"}}
        ]
      }
    }
  }
}
```

#### CheckBox ç»„ä»¶

```json
{
  "id": "agree-checkbox",
  "component": {
    "CheckBox": {
      "value": {"path": "/form/agreed"},
      "label": {"literalString": "æˆ‘åŒæ„æœåŠ¡æ¡æ¬¾"}
    }
  }
}
```

---

## æ•°æ®ç»‘å®š

A2UI ä½¿ç”¨ JSON Pointer è·¯å¾„å®ç°å“åº”å¼æ•°æ®ç»‘å®šã€‚

### å€¼ç±»å‹

æ¯ä¸ªå¯ç»‘å®šçš„å€¼éƒ½æ”¯æŒä¸¤ç§å½¢å¼ï¼š

#### å­—é¢é‡å€¼

```json
{"literalString": "å›ºå®šæ–‡æœ¬"}
{"literalNumber": 42}
{"literalBoolean": true}
```

#### è·¯å¾„ç»‘å®š

```json
{"path": "/user/name"}
{"path": "/cart/total"}
{"path": "/settings/darkMode"}
```

### å·¥ä½œåŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DataModel                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  /user/name: "å¼ ä¸‰"                                  â”‚    â”‚
â”‚  â”‚  /cart/items: [{...}, {...}]                        â”‚    â”‚
â”‚  â”‚  /cart/total: 299.99                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                  â”‚
â”‚                     æ•°æ®å˜åŒ–æ—¶                               â”‚
â”‚                           â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Text { text: {"path": "/user/name"} }              â”‚    â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â–º è‡ªåŠ¨æ˜¾ç¤º "å¼ ä¸‰"                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åŒå‘ç»‘å®š

äº¤äº’ç»„ä»¶ï¼ˆTextFieldã€CheckBoxã€Sliderï¼‰æ”¯æŒåŒå‘ç»‘å®šï¼š

1. **æ˜¾ç¤º** - ä» DataModel è¯»å–å€¼æ˜¾ç¤º
2. **æ›´æ–°** - ç”¨æˆ·æ“ä½œåå†™å› DataModel

```rust
// å½“ CheckBox è¢«ç‚¹å‡»æ—¶
A2uiSurfaceAction::DataModelChanged {
    surface_id: "main",
    path: "/payment/alipay",  // ç»‘å®šè·¯å¾„
    value: true,              // æ–°å€¼
}
```

---

## Makepad æ¸²æŸ“å™¨å®ç°

### æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Makepad Application                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  A2uiHost â†â†’ A2aClient â†â†’ SSE Stream â†â†’ A2A Server         â”‚
â”‚         â†“                                                    â”‚
â”‚  A2uiMessageProcessor                                        â”‚
â”‚         â†“                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚   Surface   â”‚    â”‚  DataModel  â”‚                         â”‚
â”‚  â”‚ (ç»„ä»¶æ ‘)    â”‚    â”‚ (æ•°æ®å­˜å‚¨)  â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚         â†“                  â†“                                 â”‚
â”‚  A2uiSurface Widget (æ¸²æŸ“ + äº‹ä»¶å¤„ç†)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¨¡å—

#### 1. A2uiHost - è¿æ¥ç®¡ç†

```rust
pub struct A2uiHost {
    config: A2uiHostConfig,
    client: Option<A2aClient>,
    stream: Option<A2aEventStream>,
}

// ä½¿ç”¨ç¤ºä¾‹
let config = A2uiHostConfig {
    url: "http://localhost:8080/rpc".to_string(),
    auth_token: None,
};
let mut host = A2uiHost::new(config);
host.connect("æ˜¾ç¤ºæ”¯ä»˜é¡µé¢")?;
```

#### 2. A2uiMessageProcessor - æ¶ˆæ¯å¤„ç†

```rust
pub struct A2uiMessageProcessor {
    surfaces: HashMap<String, Surface>,
    data_models: HashMap<String, DataModel>,
    catalog: ComponentCatalog,
}

// å¤„ç†æ¶ˆæ¯
let events = processor.process_message(a2ui_message);
```

#### 3. A2uiSurface - æ¸²æŸ“ç»„ä»¶

```rust
#[derive(Live, LiveHook, Widget)]
pub struct A2uiSurface {
    // ç»˜åˆ¶å™¨
    draw_bg: DrawQuad,
    draw_text: DrawText,
    draw_card: DrawColor,
    draw_button: DrawColor,
    draw_checkbox: DrawA2uiCheckBox,

    // çŠ¶æ€
    processor: Option<A2uiMessageProcessor>,
    button_areas: Vec<Area>,
    checkbox_areas: Vec<Area>,
    // ...
}
```

### æ¸²æŸ“æµç¨‹

```rust
fn draw_walk(&mut self, cx: &mut Cx2d, scope: &mut Scope, walk: Walk) -> DrawStep {
    // 1. å¼€å§‹ç»˜åˆ¶èƒŒæ™¯
    self.draw_bg.begin(cx, walk, self.layout);

    // 2. è·å– Surface å’Œ DataModel
    let surface = self.processor.get_surface("main");
    let data_model = self.processor.get_data_model("main");

    // 3. ä»æ ¹ç»„ä»¶é€’å½’æ¸²æŸ“
    self.render_component(cx, scope, surface, data_model, &surface.root);

    // 4. ç»“æŸç»˜åˆ¶
    self.draw_bg.end(cx);
    DrawStep::done()
}
```

### äº‹ä»¶å¤„ç†

```rust
fn handle_event(&mut self, cx: &mut Cx, event: &Event, scope: &mut Scope) {
    // å¤„ç† CheckBox ç‚¹å‡»
    for (idx, area) in self.checkbox_areas.iter().enumerate() {
        match event.hits(cx, *area) {
            Hit::FingerDown(_) => {
                self.hovered_checkbox_idx = Some(idx);
            }
            Hit::FingerUp(fe) if fe.is_over => {
                // åˆ‡æ¢é€‰ä¸­çŠ¶æ€
                let new_value = !current_value;
                cx.widget_action(
                    self.widget_uid(),
                    &scope.path,
                    A2uiSurfaceAction::DataModelChanged {
                        surface_id,
                        path: binding_path,
                        value: serde_json::Value::Bool(new_value),
                    },
                );
            }
            _ => {}
        }
    }
}
```

---

## Demo åº”ç”¨

### æ¦‚è¿°

`a2ui-demo` åº”ç”¨æ¼”ç¤ºäº†ä¸¤ç§æ¨¡å¼ï¼š

| æ¨¡å¼ | åŠŸèƒ½ | æ•°æ®æ¥æº |
|------|------|---------|
| **é™æ€æ¨¡å¼** | äº§å“ç›®å½• | æœ¬åœ° JSON |
| **æµå¼æ¨¡å¼** | æ”¯ä»˜ç»“è´¦ | Mock æœåŠ¡å™¨ |

### é™æ€æ¨¡å¼ - äº§å“ç›®å½•

å±•ç¤ºï¼š
- äº§å“åˆ—è¡¨ï¼ˆå¸¦å›¾ç‰‡ï¼‰
- ç­›é€‰å™¨ï¼ˆæœç´¢ã€å¤é€‰æ¡†ã€æ»‘å—ï¼‰
- åŠ å…¥è´­ç‰©è½¦æŒ‰é’®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ›’ Product Catalog                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Filters                          â”‚    â”‚
â”‚  â”‚ Search: [____________]           â”‚    â”‚
â”‚  â”‚ â˜‘ In Stock Only  â˜ On Sale      â”‚    â”‚
â”‚  â”‚ Max Price: â”€â”€â”€â”€â—â”€â”€â”€â”€ $150       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [IMG] Premium Headphones         â”‚    â”‚
â”‚  â”‚       $99.99      [Add to Cart]  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [IMG] Wireless Mouse             â”‚    â”‚
â”‚  â”‚       $49.99      [Add to Cart]  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµå¼æ¨¡å¼ - æ”¯ä»˜ç»“è´¦

å±•ç¤ºï¼š
- è®¢å•æ‘˜è¦
- æ”¯ä»˜æ–¹å¼é€‰æ‹©ï¼ˆå•é€‰ï¼‰
- ä»·æ ¼æ±‡æ€»
- ç¡®è®¤/å–æ¶ˆæŒ‰é’®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’³ Payment Checkout                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ“¦ Order Items                   â”‚    â”‚
â”‚  â”‚ ğŸ§ Premium Headphones    $99.99  â”‚    â”‚
â”‚  â”‚ ğŸ–±ï¸ Wireless Mouse x2     $79.98  â”‚    â”‚
â”‚  â”‚ âŒ¨ï¸ Mechanical Keyboard  $129.99  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ’° Payment Method                â”‚    â”‚
â”‚  â”‚ â—‰ ğŸ’³ Credit Card                 â”‚    â”‚
â”‚  â”‚ â—‹ ğŸ…¿ï¸ PayPal                      â”‚    â”‚
â”‚  â”‚ â—‹ [æ”¯ä»˜å®] Alipay æ”¯ä»˜å®          â”‚    â”‚
â”‚  â”‚ â—‹ [å¾®ä¿¡] WeChat Pay å¾®ä¿¡æ”¯ä»˜      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ“Š Order Summary                 â”‚    â”‚
â”‚  â”‚ Subtotal:              $309.96   â”‚    â”‚
â”‚  â”‚ Shipping:                $9.99   â”‚    â”‚
â”‚  â”‚ Tax:                    $24.80   â”‚    â”‚
â”‚  â”‚ Total:                 $344.75   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                          â”‚
â”‚  [âŒ Cancel]        [âœ… Confirm & Pay]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å•é€‰è¡Œä¸ºå®ç°

æ”¯ä»˜æ–¹å¼ä½¿ç”¨ CheckBox ç»„ä»¶ï¼Œä½†å®ç°äº†å•é€‰ï¼ˆRadioï¼‰è¡Œä¸ºï¼š

```rust
// streaming_demo.rs / app.rs
A2uiSurfaceAction::DataModelChanged { surface_id, path, value } => {
    let payment_methods = [
        "/payment/creditCard",
        "/payment/paypal",
        "/payment/alipay",
        "/payment/wechat",
    ];

    if payment_methods.contains(&path.as_str()) {
        if value == serde_json::Value::Bool(true) {
            // é€‰ä¸­ä¸€ä¸ªæ—¶ï¼Œå–æ¶ˆå…¶ä»–æ‰€æœ‰
            for method in &payment_methods {
                if *method != path {
                    data_model.set(method, serde_json::Value::Bool(false));
                }
            }
        }
    }

    data_model.set(&path, value);
}
```

---

## å¿«é€Ÿå¼€å§‹

### è¿è¡Œ Demo

#### 1. å¯åŠ¨ Mock æœåŠ¡å™¨

```bash
cargo run -p a2ui-demo --bin mock-a2a-server --features mock-server
```

è¾“å‡ºï¼š
```
===========================================
  Mock A2A Server - Payment Page Demo
===========================================
Listening on http://127.0.0.1:8080/rpc
```

#### 2. å¯åŠ¨ Demo åº”ç”¨

```bash
cargo run -p a2ui-demo
```

#### 3. æ“ä½œè¯´æ˜

- ç‚¹å‡» **"ğŸ›’ Product Catalog"** - åŠ è½½é™æ€äº§å“åˆ—è¡¨
- ç‚¹å‡» **"ğŸ’³ Payment Checkout"** - è¿æ¥æœåŠ¡å™¨ï¼Œæµå¼åŠ è½½æ”¯ä»˜é¡µé¢

### é¡¹ç›®ç»“æ„

```
crates/
â”œâ”€â”€ ui/src/a2ui/
â”‚   â”œâ”€â”€ mod.rs              # æ¨¡å—å¯¼å‡º
â”‚   â”œâ”€â”€ message.rs          # A2UI æ¶ˆæ¯ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ value.rs            # å€¼ç±»å‹ (StringValue, NumberValue, BooleanValue)
â”‚   â”œâ”€â”€ data_model.rs       # DataModel å®ç°
â”‚   â”œâ”€â”€ processor.rs        # A2uiMessageProcessor
â”‚   â”œâ”€â”€ surface.rs          # A2uiSurface Widget
â”‚   â”œâ”€â”€ host.rs             # A2uiHost è¿æ¥ç®¡ç†
â”‚   â”œâ”€â”€ a2a_client.rs       # A2A JSON-RPC å®¢æˆ·ç«¯
â”‚   â””â”€â”€ sse.rs              # SSE æµå¼ä¼ è¾“
â”‚
â””â”€â”€ a2ui-demo/src/
    â”œâ”€â”€ app.rs              # ä¸» Demo åº”ç”¨
    â”œâ”€â”€ mock_server.rs      # Mock A2A æœåŠ¡å™¨
    â””â”€â”€ streaming_demo.rs   # ç‹¬ç«‹æµå¼ Demo
```

### è‡ªå®šä¹‰æœåŠ¡å™¨

å®ç°è‡ªå·±çš„ A2A æœåŠ¡å™¨åªéœ€ï¼š

1. æ¥æ”¶ JSON-RPC è¯·æ±‚
2. è¿”å› SSE æµå¼å“åº”
3. å‘é€ A2UI æ¶ˆæ¯

```python
# ä¼ªä»£ç ç¤ºä¾‹
@app.post("/rpc")
async def handle_rpc(request):
    async def generate():
        # å‘é€ beginRendering
        yield f"data: {json.dumps(begin_rendering_msg)}\n\n"

        # å‘é€ surfaceUpdate
        yield f"data: {json.dumps(surface_update_msg)}\n\n"

        # å‘é€ dataModelUpdate
        yield f"data: {json.dumps(data_model_msg)}\n\n"

    return StreamingResponse(generate(), media_type="text/event-stream")
```

---

## å‚è€ƒèµ„æº

- **A2UI è§„èŒƒ**: `/fw/A2UI/specification/v0_9/`
- **Lit æ¸²æŸ“å™¨**: `/fw/A2UI/renderers/lit/`
- **Flutter æ¸²æŸ“å™¨ (GenUI)**: `/fw/genui/`
- **Makepad æ¡†æ¶**: `/fw/makepad/`

---

*æ–‡æ¡£ç‰ˆæœ¬: 1.0 | æœ€åæ›´æ–°: 2026-02*
